:root {
    --c-bg-deep: #0f172a;
    --c-bg-surface: #1e293b;
    --c-bg-hover: #334155;
    --c-primary: #3b82f6;
    --c-primary-hover: #60a5fa;
    --c-danger: #ef4444;
    --c-text-primary: #f8fafc;
    --c-text-secondary: #94a3b8;
    --c-border: #334155;
    --font-family: 'Inter', -apple-system, sans-serif;
    --shadow-panel: 0 4px 20px rgba(0, 0, 0, 0.4);
}
*, *::before, *::after { margin: 0; padding: 0; box-sizing: border-box; }
body { font-family: var(--font-family); background: var(--c-bg-deep); color: var(--c-text-primary); overflow: hidden; height: 100vh; }
.hidden { display: none !important; }
.app-header {
    position: absolute; top: 0; left: 0; width: 100%; height: 60px;
    background: linear-gradient(180deg, rgba(15, 23, 42, 0.95) 0%, rgba(15, 23, 42, 0.8) 100%);
    display: flex; justify-content: space-between; align-items: center;
    padding: 0 24px; 
    z-index: 1000; 
    pointer-events: none;
    border-bottom: 1px solid rgba(255,255,255,0.05);
}
.header-left, .header-center, .header-right { pointer-events: auto; }
.logo-area { display: flex; align-items: center; gap: 12px; font-weight: 700; letter-spacing: 1px; }
.logo-area svg { width: 24px; height: 24px; color: var(--c-primary); }
.logo-text span { color: var(--c-primary); }
.mode-switcher {
    background: var(--c-bg-surface); border: 1px solid var(--c-border);
    border-radius: 8px; display: flex; overflow: hidden; padding: 4px; pointer-events: auto;
}
.mode-btn {
    padding: 6px 16px; font-size: 13px; font-weight: 600; color: var(--c-text-secondary);
    cursor: pointer; border-radius: 6px; transition: 0.2s;
    display: flex; align-items: center; gap: 8px;
}
.mode-btn:hover { color: var(--c-text-primary); }
.mode-btn.active { background: var(--c-bg-hover); color: var(--c-primary); }
.mode-btn svg { width: 16px; height: 16px; }
.user-info { font-size: 13px; color: var(--c-text-secondary); }
.main-viewport { width: 100vw; height: 100vh; position: relative; }
#canvas { display: block; width: 100%; height: 100%; outline: none; }
.left-toolbar {
    position: absolute; top: 80px; left: 24px;
    background: var(--c-bg-surface); border: 1px solid var(--c-border);
    border-radius: 12px; padding: 8px; display: flex; flex-direction: column; gap: 8px;
    box-shadow: var(--shadow-panel); z-index: 50;
}
.tool-btn {
    width: 44px; height: 44px; border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    color: var(--c-text-secondary); cursor: pointer; transition: 0.2s;
}
.tool-btn:hover { background: var(--c-bg-hover); color: var(--c-text-primary); }
.tool-btn.active { background: var(--c-primary); color: white; box-shadow: 0 4px 12px rgba(59, 130, 246, 0.4); }
.tool-btn svg { width: 22px; height: 22px; }

.bottom-drawer {
    position: absolute; bottom: 24px; left: 50%; transform: translateX(-50%) translateY(120%);
    background: var(--c-bg-surface); border: 1px solid var(--c-border);
    border-radius: 12px; padding: 16px; width: 600px; max-width: 90%;
    box-shadow: var(--shadow-panel); z-index: 50;
    transition: transform 0.3s cubic-bezier(0.16, 1, 0.3, 1);
    display: flex; flex-direction: column; gap: 12px;
}
.bottom-drawer.open { transform: translateX(-50%) translateY(0); }
.drawer-header { font-size: 12px; text-transform: uppercase; letter-spacing: 0.5px; color: var(--c-text-secondary); border-bottom: 1px solid var(--c-border); padding-bottom: 8px; }
.stickers-container { display: flex; gap: 10px; overflow-x: auto; padding-bottom: 4px; }
.stickers-container::-webkit-scrollbar { height: 6px; }
.stickers-container::-webkit-scrollbar-thumb { background: var(--c-border); border-radius: 3px; }

.sticker-option {
    width: 70px; height: 70px; background: var(--c-bg-deep); border: 1px solid var(--c-border);
    border-radius: 8px; display: flex; flex-direction: column; align-items: center; justify-content: center;
    cursor: pointer; flex-shrink: 0; transition: 0.2s;
}
.sticker-option img, .sticker-option span { pointer-events: none; }
.sticker-option img { width: 32px; height: 32px; margin-bottom: 6px; } 
.sticker-option .char-sticker { font-size: 32px; line-height: 1; margin-bottom: 6px; }
.sticker-option label { font-size: 10px; color: var(--c-text-secondary); text-align: center; }
.sticker-option:hover { border-color: var(--c-text-secondary); transform: translateY(-2px); }
.sticker-option.selected { border-color: var(--c-primary); background: rgba(59, 130, 246, 0.1); }

#testing-view {
    position: absolute; inset: 0; background: var(--c-bg-deep);
    z-index: 500; 
    padding: 80px 40px 40px 40px; 
    overflow-y: auto;
    display: flex; justify-content: center;
}
.exam-container { width: 100%; max-width: 800px; }
.exam-header { margin-bottom: 30px; border-bottom: 1px solid var(--c-border); padding-bottom: 20px; }
.exam-header h2 { font-size: 24px; margin-bottom: 8px; }
.question-card { background: var(--c-bg-surface); padding: 20px; border-radius: 8px; margin-bottom: 20px; border: 1px solid var(--c-border); }
.question-card h3 { font-size: 16px; margin-bottom: 12px; color: var(--c-text-primary); }
.question-card textarea {
    width: 100%; height: 80px; background: var(--c-bg-deep); border: 1px solid var(--c-border);
    border-radius: 6px; color: var(--c-text-primary); padding: 10px; resize: vertical; outline: none;
}
.question-card textarea:focus { border-color: var(--c-primary); }
.btn-primary {
    background: var(--c-primary); color: white; border: none; padding: 12px 24px;
    border-radius: 6px; font-weight: 600; cursor: pointer; transition: 0.2s; width: 100%;
}
.btn-primary:hover { background: var(--c-primary-hover); }
.custom-modal {
    position: fixed;
    inset: 0;
    z-index: 9999;
    display: flex;
    align-items: center;
    justify-content: center;
    opacity: 1;
    transition: opacity 0.2s ease;
}
.custom-modal.hidden {
    opacity: 0;
    pointer-events: none;
}
.custom-modal-overlay {
    position: absolute;
    inset: 0;
    background: rgba(0, 0, 0, 0.7);
    backdrop-filter: blur(2px);
}
.custom-modal-content {
    position: relative;
    background: var(--c-bg-surface);
    border: 1px solid var(--c-border);
    padding: 24px;
    border-radius: 12px;
    width: 90%;
    max-width: 400px;
    box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
    transform: scale(1);
    transition: transform 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
}
.custom-modal.hidden .custom-modal-content {
    transform: scale(0.9);
}
#modal-title {
    margin-top: 0;
    color: var(--c-text-primary);
    font-size: 1.25rem;
}
#modal-message {
    color: var(--c-text-secondary);
    margin: 16px 0 24px 0;
    line-height: 1.5;
}
.modal-actions {
    display: flex;
    justify-content: flex-end;
    gap: 12px;
}