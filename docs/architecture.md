# üèó –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü—Ä–æ–µ–∫—Ç –ø–æ—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–µ **Manager**, –≥–¥–µ –∫–∞–∂–¥—ã–π –∞—Å–ø–µ–∫—Ç —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ –≤—ã–Ω–µ—Å–µ–Ω –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –º–æ–¥—É–ª—å. –°–æ—Å—Ç–æ—è–Ω–∏–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —á–µ—Ä–µ–∑ –≥–ª–æ–±–∞–ª—å–Ω—ã–π Singleton-–æ–±—ä–µ–∫—Ç.

## üîÑ –°—Ö–µ–º–∞ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è

```mermaid
[ Python Backend (FastAPI) ]  <-- HTTP / Bridge -->  [ JavaScript Frontend ]
        |                                                   |
   DB (Memory)                                         AppState (Global)
                                                            |
                                            -----------------------------------
                                            |               |                 |
                                      SceneManager    InteractionManager   UIManager
                                            |               |                 |
                                       Three.js Scene    Raycaster          DOM Elements
```

## üß† –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (`AppState.js`)

–§–∞–π–ª `js/AppState.js` ‚Äî —ç—Ç–æ —Ü–µ–Ω—Ç—Ä–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –¥–∞–Ω–Ω—ã—Ö. –í –Ω–µ–º –∂–∏–≤—É—Ç:
*   –°—Å—ã–ª–∫–∏ –Ω–∞ —Å—Ü–µ–Ω—É, –∫–∞–º–µ—Ä—É –∏ —Ä–µ–Ω–¥–µ—Ä–µ—Ä.
*   –ú–∞—Å—Å–∏–≤—ã –Ω–∞–∫–ª–µ–µ–Ω–Ω—ã—Ö —Å—Ç–∏–∫–µ—Ä–æ–≤ (`placedStickers`).
*   –ú–∞—Å—Å–∏–≤—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –∑–æ–Ω (`definedZones`).
*   –§–ª–∞–≥–∏ —Ä–µ–∂–∏–º–æ–≤ (—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ, —ç–∫–∑–∞–º–µ–Ω).

–õ—é–±–æ–π –º–æ–¥—É–ª—å –º–æ–∂–µ—Ç –∏–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å `AppState` –∏ –ø–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø –∫ —Ç–µ–∫—É—â–µ–º—É —Å–æ—Å—Ç–æ—è–Ω–∏—é –º–∏—Ä–∞.

## üîå Python-JS Bridge

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –≤ –æ–∫–Ω–µ `pywebview`.
1.  **Python -> JS:** –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `window.evaluate_js()` –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ –∫–æ–º–∞–Ω–¥ –≤ –±—Ä–∞—É–∑–µ—Ä.
2.  **JS -> Python:** Frontend –¥–µ–ª–∞–µ—Ç `fetch` –∑–∞–ø—Ä–æ—Å—ã –Ω–∞ –ª–æ–∫–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–µ—Ä FastAPI (–æ–±—ã—á–Ω–æ `http://127.0.0.1:5000`).

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ JS –º–æ–¥—É–ª–µ–π

*   **`core/`** ‚Äî –ù–∏–∑–∫–æ—É—Ä–æ–≤–Ω–µ–≤–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ Three.js (—Å–≤–µ—Ç, —Ä–µ–Ω–¥–µ—Ä –ª—É–ø, —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–∞–º–µ—Ä–æ–π).
*   **`interactions/`** ‚Äî –°–∞–º–∞—è —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞: –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∫–ª–∏–∫–æ–≤ –º—ã—à–∏, –º–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–π –ª—É—á–µ–π.
*   **`io/`** ‚Äî –ó–∞–≥—Ä—É–∑—á–∏–∫–∏ —Ñ–∞–π–ª–æ–≤ (.glb, .stl) –∏ –ø–∞—Ä—Å–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥–æ–≤.
*   **`ui/`** ‚Äî –°–≤—è–∑—å HTML-–∫–Ω–æ–ø–æ–∫ —Å –ª–æ–≥–∏–∫–æ–π –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.